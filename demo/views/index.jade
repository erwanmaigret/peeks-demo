extends layout

block content
  h1= title
  script(src="/javascripts/peeks.js")

  // Use threeJS specialization
  script(src="/javascripts/three.js")
  script(src="/javascripts/three/loaders/OBJLoader.js")
  script(src="/javascripts/peeks_three.js")

  script.
    PEEKS.setLogLevel(1);

    var peeks = new PEEKS.Scene();

    peeks.bounds = { x0: -4, y0: 0, z0: -3, x1: 4, y1: 2, z1: 3 };

    peeks.addButton({
      image: 'images/wall_bricks.jpg',
      imageRepeat: [3, 3],
      position: [0, 0, -10.1],
      rotation: [0, 0, 0],
      size: 21,
      onClick: 'toggleVisible',
    });

    peeks.addButton({
      image: 'images/wall_bricks.jpg',
      imageRepeat: [3, 3],
      position: [-10, 0, 0],
      rotation: [0, 90, 0],
      size: 21,
      onClick: 'toggleVisible',
    });

    peeks.addButton({
      image: 'images/wall_bricks.jpg',
      imageRepeat: [3, 3],
      position: [10, 0, 0],
      rotation: [0, -90, 0],
      size: 21,
      onClick: 'toggleVisible',
    });

    peeks.addImage({
      image: 'images/bloomingdales_logo.png',
      position: [0, 2.5, -4],
      size: [4, .8, 1],
    });

    peeks.addButton({
      image: 'ui/icon_reload.png',
      position: [-5, 2.5 , -4],
      size: .5,
      onClick: function() { },
    })

    peeks.addButton({
      image: 'ui/icon_previous.png',
      position: [-4, 2.5 , -4],
      size: .5,
      onClick: function() { },
    })

    peeks.addButton({
      image: 'ui/icon_next.png',
      position: [-3, 2.5 , -4],
      size: .5,
      onClick: function() { },
    })

    peeks.addButton({
      image: 'ui/icon_ar.png',
      position: [5, 2.5 , -4],
      size: .5,
      onClick: function() { peeks.toggleArMode(); },
    })

    peeks.addButton({
      image: 'ui/icon_peeks.png',
      position: [4, 2.5, -4],
    })

    peeks.addGeometry({
      geometry: 'assets/vr_controller_vive_1_5.obj',
      texture: 'assets/vr_controller_vive_1_5.png',
      position: [1.5, 0, 0],
      size: 3,
    }).animate({
      duration: 10,
      begin: [0, 0, 0],
      end: [360, 360, 360],
      attribute: 'rotation',
      loop: true
    });

    peeks.addGeometry({
      geometry: 'assets/ball_chair.obj',
      position: [-1.5, -1, 0],
      rotation: [0, 45, 0],
    });

    peeks.addButton({
      image: 'images/floor_wood.jpg',
      imageRepeat: [10, 10],
      position: [0, -1, 0],
      rotation: [-90, 0, 0],
      size: 20,
      onClick: 'toggleVisible',
    });

    for (var z = -2; z < 0; z++) {
      for (var x = 1; x <= 4; x++) {
        peeks.addImage({
          image: 'images/dress' + x.toString() + '.png',
          position: [(-2.5 + x) * 2, 0, z],
          rotation: [0, 0, 0],
          size: [1,1.5, 1],
        });
      }
    }

    var animSpeed = 2;

    peeks.camera.animate({
      duration: 10 / animSpeed,
      begin: [0, 0, 10],
      end: [0, 0, 2]
    });
    peeks.camera.animate({
      duration: 9 / animSpeed,
      delay: 1,
      p0: [0, 0, 0],
      p1: [0, 80, 10],
      p2: [0, -80, -10],
      p3: [0, 0, 0],
      attribute: 'rotation'
    });

    peeks.start(window);
